/**
 * @name angular-7segments
 * @version v0.2.0
 * @author Taewoo Kim xodn4195@gmail.com
 * @license MIT
 */
!function(t,e){function i(t){return t&&t.$evalAsync&&t.$watch}function n(t){return t&&t.window===t}function r(t,e){var r=e;return"string"==typeof t&&"$"===t.charAt(0)&&"$"===t.charAt(1)?r=void 0:n(e)?r="$WINDOW":e&&document===e?r="$DOCUMENT":i(e)&&(r="$SCOPE"),r}function s(t){var i=[];return JSON.stringify(t,function(t,n){if(n=r(t,n),e.isObject(n)){if(i.indexOf(n)>=0)return"...";i.push(n)}return n})}function o(t){return"function"==typeof t?t.toString().replace(/ \{[\s\S]*$/,""):e.isUndefined(t)?"undefined":"string"!=typeof t?s(t):t}function g(t,e){return e=e||Error,function(){var i=2,n=arguments,r=n[0],s="["+(t?t+":":"")+r+"] ",g=n[1];return s+=g.replace(/\{\d+\}/g,function(t){var e=+t.slice(1,-1),r=e+i;return r<n.length?o(n[r]):t}),new e(s)}}function a(t,i){var n={strict:"E",require:"^ngModel",scope:{segVal:"=ngModel",segDigitOptions:"="},templateUrl:"digit.html",link:function(n,r,s,o){n.opt=e.extend({},t.defaults.digit,n.segDigitOptions),n.points=i,r.addClass("seven-seg-digit-wrapper"),r.css("width",n.opt.width+"px"),r.css("height",n.opt.height+"px")}};return n}function d(t){var i={strict:"E",require:"ngModel",scope:{segOptions:"=",segDigitOptions:"=",segArr:"=ngModel"},templateUrl:"group.html",link:function(i,n){function r(e,n){try{i.digits=t.arrToSegGroup(e,n)}catch(r){i.digits=[]}}n.addClass("seven-seg-group");var s=e.copy(t.defaults.group);i.$watch("segArr",function(t){r(t,s)});var o=i.$watchCollection("segOptions",function(t){e.extend(s,t),r(i.segArr,s),s.watch||o()})}};return i}function u(){return function(t,e){return t&e}}function c(){return function(t,e){return t&1<<e}}function l(){var t=this;this.defaults={digit:{width:75,height:150,onClass:"seven-seg-on",digitClass:"seven-seg-digit"},group:{align:void 0,watch:void 0}},this.$get=["segMap",function(i){function n(){var n=this;this.isDot=function(t){return"."===t||t===i["."]},this.arrToSegGroup=function(t,r){if(!e.isArray(t)&&!e.isString(t))throw new h("badarrtype","The type '{0}' is not supported.",typeof t);if(r.size<0)throw new h("badsize","The size '{0}' cannot be negative.",r.size);for(var s=[],o=0,g=void 0===r.size?t.length:r.size,a=0,d=t.length;d>a&&g>o;o++,a++){var u=t[a]||0;if(n.isDot(u)){var c=t[a-1];void 0===c||n.isDot(c)?s[o]=i["."]:s[--o]|=i["."]}else if(e.isString(u))s[o]=i[u];else{if(!e.isNumber(u))throw new h("baditemtype","The type '{0}' is not supported.",typeof u);s[o]=u}}return n.isDot(t[a])&&(s[o-1]|=i["."]),g=void 0===r.size?o:r.size,void 0===r.align||"right"===r.align?new Array(g-o).concat(s):s.concat(new Array(g-o))},this.arrToSegNum=function(t){if(!e.isArray(t)&&!e.isString(t))throw new h("badarrtype","The type '{0}' is not supported.",typeof t);for(var i=1,n=0,r=0,s=8;s>r;i<<=1,r++)t[r]&&"0"!=t[r]&&(n|=i);return n},this.segNumToArr=function(t,e){var i=1;t=t||0;for(var n=void 0==e?t:t^e,r=[],s=0;8>s;i<<=1,s++)i&n&&(r[s]=!!(i&t));return r},this.defaults=t.defaults}return new n}]}a.$inject=["segment","segPoints"];g("segGroup");d.$inject=["segment"];var p={1:6,2:91,3:79,4:102,5:109,6:125,7:39,8:127,9:111,0:63,"-":64,_:8,".":128," ":0,S:109,E:121,G:61},f=["11 0, 37 0, 42 5, 37 10, 11 10, 6 5","38 11, 43 6, 48 11, 48 34, 43 39, 38 34","38 46, 43 41, 48 46, 48 69, 43 74, 38 69","11 70, 37 70, 42 75, 37 80, 11 80, 6 75","0 46, 5 41, 10 46, 10 69, 5 74, 0 69","0 11, 5 6, 10 11, 10 34, 5 39, 0 34","11 35, 37 35, 42 40, 37 45, 11 45, 6 40"],h=g("segment");e.module("wo.7segments",[]).directive("segDigit",a).directive("segGroup",d).value("segMap",p).value("segPoints",f).filter("bitAnd",u).filter("bitAndWithBitwise",c).provider("segment",l).run(["$document",function(t){var e=t[0].querySelector("head"),i=t[0].createElement("style");i.innerHTML=".seven-seg-digit{ fill: #320000; overflow: hidden;stroke-width: 0; height: 100%; width: 100%; background-color: Black;}.seven-seg-on{fill:red;}.seven-seg-digit-wrapper{display:inline-block;}",e.appendChild(i)}]);e.module("wo.7segments").run(["$templateCache",function(t){t.put("digit.html",'<svg data-ng-class="opt.digitClass" viewBox="0 0 57 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false"> <g> <polyline data-ng-repeat="point in points" ng-attr-points="{{point}}" data-ng-class="(segVal | bitAndWithBitwise : $index) && opt.onClass"></polyline> <circle cx="52" cy="75" r="5" data-ng-class="(segVal | bitAnd : 128) && opt.onClass"></circle> </g> </svg>'),t.put("group.html",'<div data-ng-repeat="dig in digits track by $index" seg-digit data-ng-model="dig" seg-digit-options="segDigitOptions"> </div>')}])}(window,window.angular);